/* ════════════════════════════════════════════════════════════
   AI CHATBOT — Section, message feed, input bar
   ════════════════════════════════════════════════════════════ */

/* ── Section layout ──────────────────────────────────────── */
#section-aichat {
  display       : flex;
  flex-direction: column;
  height        : 100%;
  padding       : 0;
  overflow      : hidden;
}

/* ── Chat header ─────────────────────────────────────────── */
.chat-header {
  display      : flex;
  align-items  : center;
  gap          : 10px;
  padding      : 18px 24px 14px;
  border-bottom: 1px solid var(--dash-border);
  flex-shrink  : 0;
}

.chat-header-icon {
  width           : 30px;
  height          : 30px;
  border-radius   : 8px;
  background      : rgba(var(--accent-rgb), 0.1);
  border          : 1px solid rgba(var(--accent-rgb), 0.2);
  display         : flex;
  align-items     : center;
  justify-content : center;
  flex-shrink     : 0;
}

.chat-header-icon svg {
  width       : 15px;
  height      : 15px;
  stroke      : var(--dash-accent);
  fill        : none;
  stroke-width: 1.8;
  stroke-linecap: round;
  stroke-linejoin: round;
  filter      : drop-shadow(0 0 5px rgba(var(--accent-rgb), 0.5));
}

.chat-header-meta {
  flex: 1;
  min-width: 0;
}

.chat-header-title {
  font-size     : 13px;
  font-weight   : 700;
  letter-spacing: 0.12em;
  color         : var(--dash-accent);
  text-shadow   : 0 0 10px rgba(var(--accent-rgb), 0.3);
}

.chat-header-sub {
  font-size     : 10px;
  letter-spacing: 0.08em;
  color         : var(--dash-text-dim);
  margin-top    : 2px;
}

.chat-status-dot {
  width        : 7px;
  height       : 7px;
  border-radius: 50%;
  background   : var(--dash-green);
  box-shadow   : 0 0 7px var(--dash-green);
  flex-shrink  : 0;
  animation    : chatDotPulse 2.4s ease-in-out infinite;
}

@keyframes chatDotPulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.45; }
}

.chat-clear-btn {
  display      : flex;
  align-items  : center;
  gap          : 5px;
  padding      : 5px 10px;
  border-radius: 5px;
  border       : 1px solid var(--dash-border);
  background   : none;
  color        : var(--dash-text-dim);
  font-size    : 10px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-family  : var(--font-mono);
  cursor       : pointer;
  transition   : color 0.18s, border-color 0.18s, background 0.18s;
  flex-shrink  : 0;
}

.chat-clear-btn:hover {
  color        : var(--dash-red);
  border-color : rgba(255, 77, 106, 0.3);
  background   : rgba(255, 77, 106, 0.06);
}

.chat-clear-btn svg {
  width       : 11px;
  height      : 11px;
  stroke      : currentColor;
  fill        : none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* ── Message feed ────────────────────────────────────────── */
.chat-feed {
  flex      : 1;
  overflow-y: auto;
  padding   : 18px 24px;
  display   : flex;
  flex-direction: column;
  gap       : 14px;
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--accent-rgb), 0.15) transparent;
}

.chat-feed::-webkit-scrollbar { width: 4px; }
.chat-feed::-webkit-scrollbar-track { background: transparent; }
.chat-feed::-webkit-scrollbar-thumb {
  background   : rgba(var(--accent-rgb), 0.2);
  border-radius: 4px;
}

/* ── Welcome state ───────────────────────────────────────── */
.chat-welcome {
  display        : flex;
  flex-direction : column;
  align-items    : center;
  justify-content: center;
  gap            : 12px;
  padding        : 48px 24px;
  text-align     : center;
  opacity        : 0.7;
}

.chat-welcome-icon {
  width        : 48px;
  height       : 48px;
  border-radius: 12px;
  background   : rgba(var(--accent-rgb), 0.08);
  border       : 1px solid rgba(var(--accent-rgb), 0.15);
  display      : flex;
  align-items  : center;
  justify-content: center;
}

.chat-welcome-icon svg {
  width       : 22px;
  height      : 22px;
  stroke      : var(--dash-accent);
  fill        : none;
  stroke-width: 1.5;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.chat-welcome h3 {
  font-size     : 14px;
  font-weight   : 700;
  letter-spacing: 0.1em;
  color         : var(--dash-text);
  margin        : 0;
}

.chat-welcome p {
  font-size  : 11px;
  color      : var(--dash-text-dim);
  margin     : 0;
  max-width  : 280px;
  line-height: 1.6;
}

.chat-welcome-chips {
  display  : flex;
  flex-wrap: wrap;
  gap      : 7px;
  justify-content: center;
  margin-top: 6px;
}

.chat-chip {
  padding      : 5px 12px;
  border-radius: 20px;
  border       : 1px solid rgba(var(--accent-rgb), 0.2);
  background   : rgba(var(--accent-rgb), 0.05);
  color        : var(--dash-text);
  font-size    : 10px;
  letter-spacing: 0.06em;
  cursor       : pointer;
  font-family  : var(--font-mono);
  transition   : background 0.18s, border-color 0.18s, color 0.18s;
}

.chat-chip:hover {
  background   : rgba(var(--accent-rgb), 0.12);
  border-color : rgba(var(--accent-rgb), 0.4);
  color        : var(--dash-accent);
}

/* ── Message rows ────────────────────────────────────────── */
.chat-row {
  display : flex;
  gap     : 10px;
  max-width: 85%;
  animation: chatMsgIn 0.22s ease both;
}

@keyframes chatMsgIn {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}

.chat-row--ai {
  align-self : flex-start;
  align-items: flex-end;
}

.chat-row--user {
  align-self  : flex-end;
  flex-direction: row-reverse;
}

/* Avatar bubble */
.chat-av {
  width        : 26px;
  height       : 26px;
  border-radius: 7px;
  display      : flex;
  align-items  : center;
  justify-content: center;
  flex-shrink  : 0;
  font-size    : 10px;
  font-weight  : 700;
  letter-spacing: 0.04em;
}

.chat-av--ai {
  background: rgba(var(--accent-rgb), 0.12);
  border    : 1px solid rgba(var(--accent-rgb), 0.25);
  color     : var(--dash-accent);
}

.chat-av--user {
  background: rgba(var(--accent-rgb), 0.2);
  border    : 1px solid rgba(var(--accent-rgb), 0.35);
  color     : var(--dash-accent);
}

/* Message bubble */
.chat-bubble {
  padding      : 10px 14px;
  border-radius: 10px;
  font-size    : 12px;
  line-height  : 1.65;
  letter-spacing: 0.02em;
  max-width    : 100%;
  word-break   : break-word;
}

.chat-row--ai .chat-bubble {
  background   : var(--dash-surface3);
  border       : 1px solid var(--dash-border);
  color        : var(--dash-text);
  border-radius: 10px 10px 10px 2px;
}

.chat-row--user .chat-bubble {
  background   : rgba(var(--accent-rgb), 0.12);
  border       : 1px solid rgba(var(--accent-rgb), 0.25);
  color        : var(--dash-text);
  border-radius: 10px 10px 2px 10px;
}

/* Sender label */
.chat-meta {
  font-size     : 9px;
  letter-spacing: 0.1em;
  color         : var(--dash-text-faint);
  margin-bottom : 4px;
  text-transform: uppercase;
}

.chat-row--ai .chat-meta  { text-align: left; color: rgba(var(--accent-rgb), 0.45); }
.chat-row--user .chat-meta { text-align: right; }

.chat-col {
  display       : flex;
  flex-direction: column;
  min-width     : 0;
}

/* ── Typing indicator ────────────────────────────────────── */
.chat-typing {
  display    : flex;
  align-self : flex-start;
  gap        : 10px;
  align-items: flex-end;
  animation  : chatMsgIn 0.22s ease both;
}

.chat-typing-dots {
  display        : flex;
  align-items    : center;
  gap            : 4px;
  padding        : 10px 14px;
  background     : var(--dash-surface3);
  border         : 1px solid var(--dash-border);
  border-radius  : 10px 10px 10px 2px;
}

.chat-typing-dots span {
  width        : 5px;
  height       : 5px;
  border-radius: 50%;
  background   : var(--dash-accent);
  opacity      : 0.4;
  animation    : chatDot 1.2s ease-in-out infinite;
}

.chat-typing-dots span:nth-child(2) { animation-delay: 0.2s; }
.chat-typing-dots span:nth-child(3) { animation-delay: 0.4s; }

@keyframes chatDot {
  0%, 80%, 100% { transform: scale(0.7); opacity: 0.4; }
  40%           { transform: scale(1.1); opacity: 1;   }
}

/* ── Input bar ───────────────────────────────────────────── */
.chat-input-bar {
  display      : flex;
  align-items  : flex-end;
  gap          : 8px;
  padding      : 14px 24px;
  border-top   : 1px solid var(--dash-border);
  background   : var(--dash-surface);
  flex-shrink  : 0;
}

.chat-input {
  flex        : 1;
  background  : var(--dash-surface3);
  border      : 1px solid var(--dash-border);
  border-radius: 8px;
  color       : var(--dash-text);
  font-family : var(--font-mono);
  font-size   : 12px;
  padding     : 10px 14px;
  resize      : none;
  min-height  : 38px;
  max-height  : 120px;
  overflow-y  : auto;
  outline     : none;
  transition  : border-color 0.18s;
  line-height : 1.5;
  letter-spacing: 0.02em;
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--accent-rgb), 0.15) transparent;
}

.chat-input:focus {
  border-color: rgba(var(--accent-rgb), 0.4);
}

.chat-input::placeholder {
  color  : var(--dash-text-faint);
  opacity: 1;
}

.chat-send-btn {
  width        : 38px;
  height       : 38px;
  border-radius: 8px;
  background   : rgba(var(--accent-rgb), 0.12);
  border       : 1px solid rgba(var(--accent-rgb), 0.25);
  color        : var(--dash-accent);
  display      : flex;
  align-items  : center;
  justify-content: center;
  cursor       : pointer;
  flex-shrink  : 0;
  transition   : background 0.18s, filter 0.18s, transform 0.12s;
}

.chat-send-btn:hover:not(:disabled) {
  background: rgba(var(--accent-rgb), 0.22);
  filter    : drop-shadow(0 0 6px rgba(var(--accent-rgb), 0.4));
}

.chat-send-btn:active:not(:disabled) {
  transform: scale(0.92);
}

.chat-send-btn:disabled {
  opacity: 0.4;
  cursor : not-allowed;
}

.chat-send-btn svg {
  width       : 15px;
  height      : 15px;
  stroke      : currentColor;
  fill        : none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* ── Error message ───────────────────────────────────────── */
.chat-error {
  font-size    : 11px;
  color        : var(--dash-red);
  padding      : 8px 14px;
  background   : rgba(255, 77, 106, 0.07);
  border       : 1px solid rgba(255, 77, 106, 0.2);
  border-radius: 8px;
  align-self   : flex-start;
  max-width    : 85%;
}

/* ── Collapsed sidebar hides labels ──────────────────────── */
#dashboard-screen.sidebar-collapsed .nav-label { display: none; }
